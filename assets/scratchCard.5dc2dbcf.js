import{e as u,p as s,q as d,o,l as m,m as n,$ as p,a0 as f,a1 as j,O as v,S as _,s as g}from"./vendor.41992c2b.js";import{b as r}from"./index.2dffc599.js";import{_ as y}from"./index.fc30e23a.js";import"./susu3.f7883a8f.js";const b=u({setup(){return{c1:s(""),ctx:s(""),ismousedown:s(!1),fontem:s(""),isScratch:s(!1),showPrize:s(!1),getImageUrl:r,imageList:s([{url:"images/1.gif",comment:"\u5E73\u5E95\u9505"},{url:null,comment:"\u5C41"},{url:null,comment:"\u5C41"},{url:"images/3.gif",comment:"\u8868\u60C5"},{url:"images/1.jpg",comment:"\u7F8E\u5973"},{url:"images/2.jpg",comment:"\u7F8E\u5973"},{url:"images/3.jpg",comment:"\u7F8E\u5973"},{url:"images/4.jpg",comment:"\u7F8E\u5973"},{url:"images/5.jpg",comment:"\u7F8E\u5973"},{url:"images/6.jpg",comment:"\u7F8E\u5973"},{url:"images/7.jpg",comment:"\u7F8E\u5973"},{url:"images/8.jpg",comment:"\u7F8E\u5973"},{url:"images/9.jpg",comment:"\u7F8E\u5973"},{url:"images/10.jpg",comment:"\u7F8E\u5973"},{url:"images/11.jpg",comment:"\u7F8E\u5973"},{url:"images/12.jpg",comment:"\u7F8E\u5973"},{url:"images/13.jpg",comment:"\u7F8E\u5973"},{url:"images/14.jpg",comment:"\u7F8E\u5973"},{url:"images/15.jpg",comment:"\u6A80\u846D\u8001\u5A46",time:2e3},{url:"images/16.jpg",comment:"\u6A80\u846D\u8001\u5A46",time:2e3},{url:"images/17.jpg",comment:"\u7F8E\u5973"},{url:"images/18.jpg",comment:"\u7F8E\u5973"},{url:"images/19.jpg",comment:"\u5C0F\u4E03\u59D0\u59D0",time:2e3},{url:"images/20.jpg",comment:"\u5C0F\u54E5\u54E5"},{url:"images/21.jpg",comment:"\u5C0F\u54E5\u54E5"},{url:"images/22.jpg",comment:"\u7F8E\u5973"},{url:"images/7.png",comment:"\u7F8E\u5973"},{url:"images/6.png",comment:"\u7F8E\u5973"},{url:"img/xiaoyi1.jpg",comment:"\u5C0F\u6613",time:500},{url:"img/susu.jpg",comment:"\u82CF\u82CF",time:500}]),imgObj:d({url:"",comment:""})}},mounted(){this.fontem=parseInt(window.getComputedStyle(document.documentElement,null)["font-size"]),this.scratchCard=document.getElementById("scratch_card"),this.c1=document.getElementById("c1"),this.c1.width=this.c1.clientWidth,this.c1.height=this.c1.clientHeight,this.ctx=this.c1.getContext("2d"),this.initCanvas()},created(){let t=this.$route.query.index?this.$route.query.index:parseInt(Math.random()*(this.imageList.length+10)),e=this.imageList[t]||this.imageList[0];this.imgObj=e,this.imgObj.url=e.url?r(e.url):null,console.log(e,t)},methods:{initCanvas(){this.ctx.globalCompositeOperation="source-over",this.ctx.fillStyle="#e5e5e5",this.ctx.fillRect(0,0,this.c1.clientWidth,this.c1.clientHeight),this.ctx.fill(),this.ctx.font="Bold 24px Arial",this.ctx.textAlign="center",this.ctx.fillStyle="#a0a0a0",this.ctx.globalCompositeOperation="destination-out"},touchstart(t){t.preventDefault(),this.ismousedown=!0},touchend(t){sessionStorage.setItem("isScratch",!0),t.preventDefault();for(var e=this.ctx.getImageData(0,0,this.c1.width,this.c1.height),a=0,i=3;i<e.data.length;i+=4)e.data[i]==0&&a++;a>=e.data.length/8&&(this.isScratch=!0),this.ismousedown=!1},touchmove(t){if(this.showPrize=!0,t.preventDefault(),this.ismousedown){t.changedTouches&&(t=t.changedTouches[t.changedTouches.length-1]);var e=document.getElementById("scratch_card").offsetTop,a=this.c1.offsetLeft,i=this.c1.offsetTop+e,l=(t.clientX+document.body.scrollLeft||t.pageX)-a||0,h=(t.clientY+document.body.scrollTop||t.pageY)-i||0;this.ctx.beginPath(),this.ctx.arc(l,h,this.fontem*.5,0,Math.PI*2,!0),this.ctx.fill()}}},watch:{isScratch(){this.isScratch&&this.imgObj.time&&setTimeout(()=>{this.imgObj=this.imageList[0],this.imgObj.url=r(this.imgObj.url),this.isScratch=!1,this.$message({type:"success",message:"\u522B\u7785\u4E86\uFF0C\u6CA1\u4E86"})},this.imgObj.time)}}}),w={class:"container",id:"scratch_card"},S={key:0,class:"title"},x={key:1,class:"title"},O=g(" \u606D\u559C\u4F60\u83B7\u5F97"),C={class:"color-red"},T=g("\u4E00\u4E2A "),I={class:"award_box"},$={key:0,class:"award"},k=["src"],B={key:1,class:"comment"};function L(t,e,a,i,l,h){return o(),m("div",w,[t.isScratch?(o(),m("div",x,[O,n("span",C,p(t.imgObj.comment),1),T])):(o(),m("div",S,"\u522E\u5F00\u6709\u5956")),n("div",I,[t.showPrize?(o(),m("div",$,[t.imgObj.url?(o(),m("img",{key:0,class:f({auto_img:t.isScratch}),src:t.imgObj.url,alt:""},null,10,k)):(o(),m("span",B,"\u5565\u4E5F\u6CA1\u6709\uFF0C\u5565\u4E5F\u4E0D\u662F"))])):j("",!0),v(n("canvas",{id:"c1",class:"canvas",onTouchmove:e[0]||(e[0]=(...c)=>t.touchmove&&t.touchmove(...c)),onTouchstart:e[1]||(e[1]=(...c)=>t.touchstart&&t.touchstart(...c)),onTouchend:e[2]||(e[2]=(...c)=>t.touchend&&t.touchend(...c))},null,544),[[_,!t.isScratch]])])])}var q=y(b,[["render",L],["__scopeId","data-v-ff250d18"]]);export{q as default};
