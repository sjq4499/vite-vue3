import{_ as d,d as u,r as i,t as m,a as f,j as a,k as r,u as p,v,x as j,y as _,z as w,n as g,o}from"./index-b216529e.js";const x=u({setup(){return{c1:i(""),ctx:i(""),ismousedown:i(!1),fontem:i(""),isScratch:i(!1),showPrize:i(!1),getImageUrl:m,imageList:i([{url:"images/1.gif",comment:"\u5E73\u5E95\u9505"},{url:null,comment:"\u5C41"},{url:null,comment:"\u5C41"},{url:"images/3.gif",comment:"\u8868\u60C5"},{url:"images/1.jpg",comment:"\u7F8E\u5973"},{url:"images/2.jpg",comment:"\u7F8E\u5973"},{url:"images/3.jpg",comment:"\u7F8E\u5973"},{url:"images/4.jpg",comment:"\u7F8E\u5973"},{url:"images/5.jpg",comment:"\u7F8E\u5973"},{url:"images/6.jpg",comment:"\u7F8E\u5973"},{url:"images/7.jpg",comment:"\u7F8E\u5973"},{url:"images/8.jpg",comment:"\u7F8E\u5973"},{url:"images/9.jpg",comment:"\u7F8E\u5973"},{url:"images/10.jpg",comment:"\u7F8E\u5973"},{url:"images/11.jpg",comment:"\u7F8E\u5973"},{url:"images/12.jpg",comment:"\u7F8E\u5973"},{url:"images/13.jpg",comment:"\u7F8E\u5973"},{url:"images/14.jpg",comment:"\u7F8E\u5973"},{url:"images/15.jpg",comment:"\u6A80\u846D\u8001\u5A46",time:2e3},{url:"images/16.jpg",comment:"\u6A80\u846D\u8001\u5A46",time:2e3},{url:"images/17.jpg",comment:"\u7F8E\u5973"},{url:"images/18.jpg",comment:"\u7F8E\u5973"},{url:"images/19.jpg",comment:"\u5C0F\u4E03\u59D0\u59D0",time:2e3},{url:"images/20.jpg",comment:"\u5C0F\u54E5\u54E5"},{url:"images/21.jpg",comment:"\u5C0F\u54E5\u54E5"},{url:"images/22.jpg",comment:"\u7F8E\u5973"},{url:"images/7.png",comment:"\u7F8E\u5973"},{url:"images/6.png",comment:"\u7F8E\u5973"},{url:"img/xiaoyi1.jpg",comment:"\u5C0F\u6613",time:500},{url:"img/susu.jpg",comment:"\u82CF\u82CF",time:500}]),imgObj:f({url:"",comment:""})}},mounted(){this.fontem=parseInt(window.getComputedStyle(document.documentElement,null)["font-size"]),this.scratchCard=document.getElementById("scratch_card"),this.c1=document.getElementById("c1"),this.c1.width=this.c1.clientWidth,this.c1.height=this.c1.clientHeight,this.ctx=this.c1.getContext("2d"),this.initCanvas()},created(){let t=this.$route.query.index?this.$route.query.index:parseInt(Math.random()*(this.imageList.length+10)),e=this.imageList[t]||this.imageList[0];this.imgObj=e,this.imgObj.url=e.url?m(e.url):null,console.log(e,t)},methods:{initCanvas(){this.ctx.globalCompositeOperation="source-over",this.ctx.fillStyle="#e5e5e5",this.ctx.fillRect(0,0,this.c1.clientWidth,this.c1.clientHeight),this.ctx.fill(),this.ctx.font="Bold 24px Arial",this.ctx.textAlign="center",this.ctx.fillStyle="#a0a0a0",this.ctx.globalCompositeOperation="destination-out"},touchstart(t){t.preventDefault(),this.ismousedown=!0},touchend(t){sessionStorage.setItem("isScratch",!0),t.preventDefault();for(var e=this.ctx.getImageData(0,0,this.c1.width,this.c1.height),n=0,s=3;s<e.data.length;s+=4)e.data[s]==0&&n++;n>=e.data.length/8&&(this.isScratch=!0),this.ismousedown=!1},touchmove(t){if(this.showPrize=!0,t.preventDefault(),this.ismousedown){t.changedTouches&&(t=t.changedTouches[t.changedTouches.length-1]);var e=document.getElementById("scratch_card").offsetTop,n=this.c1.offsetLeft,s=this.c1.offsetTop+e,l=(t.clientX+document.body.scrollLeft||t.pageX)-n||0,h=(t.clientY+document.body.scrollTop||t.pageY)-s||0;this.ctx.beginPath(),this.ctx.arc(l,h,this.fontem*.5,0,Math.PI*2,!0),this.ctx.fill()}}},watch:{isScratch(){this.isScratch&&this.imgObj.time&&setTimeout(()=>{this.imgObj=this.imageList[0],this.imgObj.url=m(this.imgObj.url),this.isScratch=!1,this.$message({type:"success",message:"\u522B\u7785\u4E86\uFF0C\u6CA1\u4E86"})},this.imgObj.time)}}}),b={class:"container",id:"scratch_card"},y={key:0,class:"title"},S={key:1,class:"title"},O=g(" \u606D\u559C\u4F60\u83B7\u5F97"),C={class:"color-red"},T=g("\u4E00\u4E2A "),I={class:"award_box"},k={key:0,class:"award"},z=["src"],B={key:1,class:"comment"};function L(t,e,n,s,l,h){return o(),a("div",b,[t.isScratch?(o(),a("div",S,[O,r("span",C,p(t.imgObj.comment),1),T])):(o(),a("div",y,"\u522E\u5F00\u6709\u5956")),r("div",I,[t.showPrize?(o(),a("div",k,[t.imgObj.url?(o(),a("img",{key:0,class:v({auto_img:t.isScratch}),src:t.imgObj.url,alt:""},null,10,z)):(o(),a("span",B,"\u5565\u4E5F\u6CA1\u6709\uFF0C\u5565\u4E5F\u4E0D\u662F"))])):j("",!0),_(r("canvas",{id:"c1",class:"canvas",onTouchmove:e[0]||(e[0]=(...c)=>t.touchmove&&t.touchmove(...c)),onTouchstart:e[1]||(e[1]=(...c)=>t.touchstart&&t.touchstart(...c)),onTouchend:e[2]||(e[2]=(...c)=>t.touchend&&t.touchend(...c))},null,544),[[w,!t.isScratch]])])])}var D=d(x,[["render",L],["__scopeId","data-v-ff250d18"]]);export{D as default};
